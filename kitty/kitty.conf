# Themes and background
# ---

# Start with the theme, because we might want to override some seetings. Additionally, dynamic
# background opacity needs to be enabled after the background color.
include themes/catppuccin-mocha.conf

dynamic_background_opacity yes
background_opacity 1.00
map kitty_mod+a>m set_background_opacity +0.20
map kitty_mod+a>l set_background_opacity -0.20


# Windows and tabs
# ---

initial_window_height 55c
initial_window_width 220c
remember_window_size no

draw_minimal_borders false
window_border_width 2.25
window_margin_width 1.5
single_window_margin_width 0

# Looks a bit better than `center`, perhaps because of the titlebar.
placement_strategy bottom

wayland_titlebar_color background
tab_bar_style slant
enable_audio_bell no

# Open new tabs and windows on current working directory...
map kitty_mod+enter new_window_with_cwd
map kitty_mod+t new_tab_with_cwd
map kitty_mod+n new_os_window_with_cwd

# ... but keep a mapping for opening a new OS with a clear CWD; this is more efficient than using a
# new Kitty instance from my system shortcut.
map ctrl+shift+alt+n new_os_window

# Make switching windows and tabs more ergonomic.
map kitty_mod+j next_window
map kitty_mod+k previous_window
map kitty_mod+alt+j next_tab
map kitty_mod+alt+k previous_tab

# Disable some work-loosing default mappings.
map kitty_mod+q no_op
map kitty_mod+w no_op


# Fonts and text input
# ---

disable_ligatures cursor
map kitty_mod+o disable_ligatures_in active cursor
map kitty_mod+i disable_ligatures_in active always
map kitty_mod+backspace change_font_size current 0

# On Wayland, if ibus is installed, it takes precedence over Kitty's unicode_input for the
# `ctrl+shift+u` shortcut. (This doesn't happen on X11).
wayland_enable_ime no


# Scrollback and shell integration
# ---

# Will manually enable shell integration later (see fish/config.fish).
shell_integration disabled

# Try a shorter main scrollback buffer, complemented by a large scrollback *pager* buffer.
scrollback_lines 10_000
scrollback_pager_history_size 100

# Send the output of previous commands to the clipboard.
map f8 launch --stdin-source=@last_cmd_output --type clipboard
map f7 launch --stdin-source=@last_visited_cmd_output --type clipboard


# Overrides
# ---

# $HOST-dependent overrides. Requires setting $HOST in /etc/environment).
include ${HOST}.conf

# Force kitty to use its embeeded pure NERD font for NERD symbols. Must come after $HOST overrides
# because they set fomt-family.
# https://sw.kovidgoyal.net/kitty/faq/#kitty-is-not-able-to-use-my-favorite-font
symbol_map U+e000-U+e00a,U+ea60-U+ebeb,U+e0a0-U+e0c8,U+e0ca,U+e0cc-U+e0d7,U+e200-U+e2a9,U+e300-U+e3e3,U+e5fa-U+e6b7,U+e700-U+e8ef,U+ed00-U+efc1,U+f000-U+f2ff,U+f000-U+f2e0,U+f300-U+f381,U+f400-U+f533,U+f0001-U+f1af0 Symbols Nerd Font Mono
